---
import HeaderLink from './HeaderLink.astro';
---

<header>
  <nav>
    <a href="/">
      <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path class="logo-light" d="M6.58824 13.1765L3.29412 20.5882L0 14L6.58824 0V13.1765Z" fill="url(#gr-1)"/>
        <path class="logo-light" d="M14 28L6.58824 13.1765V0L14 14.8235V28Z" fill="url(#gr-2)"/>
        <path class="logo-light" d="M21.4118 13.1765L24.7059 20.5882L28 14L21.4118 0V13.1765Z" fill="url(#gr-3)"/>
        <path class="logo-light" d="M14 28L21.4118 13.1765V0L14 14.8235V28Z" fill="url(#gr-4)"/>
        <path class="logo-dark" d="M6.58824 13.1765L3.29412 20.5882L0 14L6.58824 0V13.1765Z" fill="url(#gr-5)"/>
        <path class="logo-dark" d="M14 28L6.58824 13.1765V0L14 14.8235V28Z" fill="url(#gr-6)"/>
        <path class="logo-dark" d="M21.4118 13.1765L24.7059 20.5882L28 14L21.4118 0V13.1765Z" fill="url(#gr-7)"/>
        <path class="logo-dark" d="M14 28L21.4118 13.1765V0L14 14.8235V28Z" fill="url(#gr-8)"/>
        <defs>
        <linearGradient id="gr-1" x1="6.58824" y1="7.32271e-07" x2="6.58824" y2="20.5882" gradientUnits="userSpaceOnUse">
        <stop stop-color="white"/>
        <stop offset="1" stop-color="#CECECE"/>
        </linearGradient>
        <linearGradient id="gr-2" x1="14" y1="2.47057" x2="6.58824" y2="2.47057" gradientUnits="userSpaceOnUse">
        <stop stop-color="#CECECE"/>
        <stop offset="1" stop-color="white"/>
        </linearGradient>
        <linearGradient id="gr-3" x1="28" y1="0" x2="21.4118" y2="1.28778e-07" gradientUnits="userSpaceOnUse">
        <stop stop-color="#CECECE"/>
        <stop offset="1" stop-color="white"/>
        </linearGradient>
        <linearGradient id="gr-4" x1="21.4118" y1="14" x2="14" y2="14" gradientUnits="userSpaceOnUse">
        <stop stop-color="#CECECE"/>
        <stop offset="1" stop-color="white"/>
        </linearGradient>
        <linearGradient id="gr-5" x1="6.58824" y1="7.32271e-07" x2="6.58824" y2="20.5882" gradientUnits="userSpaceOnUse">
        <stop stop-color="#7B7B7B"/>
        <stop offset="1"/>
        </linearGradient>
        <linearGradient id="gr-6" x1="14" y1="2.47057" x2="6.58824" y2="2.47057" gradientUnits="userSpaceOnUse">
        <stop stop-color="#434343"/>
        <stop offset="1"/>
        </linearGradient>
        <linearGradient id="gr-7" x1="28" y1="0" x2="21.4118" y2="1.28778e-07" gradientUnits="userSpaceOnUse">
        <stop stop-color="#7B7B7B"/>
        <stop offset="1"/>
        </linearGradient>
        <linearGradient id="gr-8" x1="21.4118" y1="14" x2="14" y2="14" gradientUnits="userSpaceOnUse">
        <stop stop-color="#434343"/>
        <stop offset="1"/>
        </linearGradient>
        </defs>
      </svg>
    </a>
    <div class="internal-links">
      <HeaderLink href="/">Home</HeaderLink>
      <HeaderLink href="/blog">Writing</HeaderLink>
      <HeaderLink href="/about">About</HeaderLink>
    </div>
  </nav>
  <div class="toolbar">
    <button id="theme-button">
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path class="moon" d="M11.6666 5V3.33334M10.8333 4.16667H12.5M15.8333 5.83334V9.16667M17.5 7.5H14.1666M14.5 13.3333C12.4166 14 9.99996 13.5833 8.33329 11.9167C6.24996 9.83334 6.08329 6.5 7.74996 4.16667C4.33329 4.5 1.66663 7.33334 1.66663 10.8333C1.66663 14.5 4.66663 17.5 8.33329 17.5C11.0833 17.5 13.5 15.75 14.5 13.3333Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
        <path class="sun" d="M9.99992 15.2083V17.2917M9.99992 2.70833V4.79166M6.31742 13.6825L4.84409 15.1558M15.1558 4.84416L13.6824 6.3175M4.79158 9.99999H2.70825M17.2916 9.99999H15.2083M6.31742 6.3175L4.84409 4.84416M15.1558 15.1558L13.6824 13.6825M12.4999 9.99999C12.4999 11.3807 11.3806 12.5 9.99992 12.5C8.61921 12.5 7.49992 11.3807 7.49992 9.99999C7.49992 8.61928 8.61921 7.49999 9.99992 7.49999C11.3806 7.49999 12.4999 8.61928 12.4999 9.99999Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
    </button>
    <div class="social-links">
      <HeaderLink href="https://twitter.com/ivomynttinen">X</HeaderLink>
      <HeaderLink href="https://mastodon.design/@ivomynttinen">Mastodon</HeaderLink>
      <HeaderLink href="https://layers.to/ivomynttinen">Layers</HeaderLink>
      <HeaderLink href="https://github.com/ivomynttinen">Github</HeaderLink>
    </div>
  </div>
</header>

<script>
  document.addEventListener('astro:page-load', () => {
    const theme = (() => {
      if (typeof localStorage !== "undefined" && localStorage.getItem("theme")) {
        return localStorage.getItem("theme");
      }
      if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
        return "dark";
      }
      return "light";
    })();

    if (theme === "light") {
      document.documentElement.classList.remove("dark");
    } else {
      document.documentElement.classList.add("dark");
    }

    window.localStorage.setItem("theme", theme || "");

    const handleToggleClick = () => {
      const element = document.documentElement;
      element.classList.toggle("dark");

      const isDark = element.classList.contains("dark");
      localStorage.setItem("theme", isDark ? "dark" : "light");
    };

    const themeToggle = document.getElementById("theme-button");
    if (themeToggle) {
      themeToggle.addEventListener("click", handleToggleClick);
    }
  });
</script>

<style>
  header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: .75rem 1rem;
  }

  nav{
    display: flex;
    align-items: center;
    gap: 24px;
  }

  nav, .toolbar {
    display: flex;
    align-items: center;
  }

  .internal-links,
  .social-links{
    display: flex;
    align-items: center;
    gap: 2px;
  }

  .social-links{
    &:before{
      content: '';
      width: 1px;
      height: .75rem;
      border-radius: 1px;
      margin: 0 .25rem;
      background-color: var(--gray-6);
    }
  }

  button {
    border: 0;
    background: none;
    border-radius: 6px;
    color: var(--gray-11);
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 32px;
    cursor: pointer;
    transition: color 0.2s, background 0.2s;

    &:hover{
      color: var(--gray-12);
      background: var(--gray-2);
    }

    &:active{
      color: var(--gray-12);
      background: var(--gray-3);
    }

    &.active{
      color: var(--gray-12);
      background: var(--gray-3);
    }
  }

  .sun { opacity: 0; }
  .moon { opacity: 1; }
  .logo-dark { opacity: 1; }
  .logo-light { opacity: 0; }

  :global(.dark) .sun { opacity: 1; }
  :global(.dark) .moon { opacity: 0; }
  :global(.dark) .logo-dark { opacity: 0; }
  :global(.dark) .logo-light { opacity: 1; }
</style>


